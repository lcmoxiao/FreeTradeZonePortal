<!DOCTYPE html>
<html lang="zh">
<head>
    <title>myWork</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta charset="utf-8">
    <script src="/js/jquery-3.5.1.min.js"></script>

    <script type="text/javascript" src="/js/work.model.js"></script>
    <link rel="stylesheet" href="/css/work.model.css" media="all">

    <link rel="stylesheet" href="/layui/css/layui.css" media="all">
</head>
<body>

<div>
    <div id="navigator"></div>
    <div id="mainContent"></div>
</div>


<script>
    $.ready(showNavigator());
    $.ready(showWorkStep());


    function showWorkStep() {
        $.ajax({
            url: "/work/needDoing",
            method: "get",
            success: function (res) {
                let tmp = "<table class=\"layui-table\">\n" +
                    "            <thead>\n" +
                    "            <tr>\n" +
                    "                <td>事务ID</td>\n" +
                    "                <td>事务名</td>\n" +
                    "                <td>事务描述</td>\n" +
                    "                <td>附件</td>\n" +
                    "                <td>处理</td>\n" +
                    "            </tr>\n" +
                    "            </thead>\n" +
                    "            <tbody id=\"tbody\">\n";
                for (let i = 0; i < res.length; i++) {
                    tmp += "<tr>" +
                        "<td>" + res[i]['wsId'] + "</td>" +
                        "<td>" + res[i]['wsName'] + "</td>" +
                        "<td>" + res[i]['wsdesc'] + "</td>" +
                        "<td>" + res[i]['wFile'] + "</td>" +
                        "<td>" +
                        "<button class=\"layui-btn layui-btn-warm layui-btn-sm\" onclick=doWork(" +
                        res[i]['wId'] + "," +
                        res[i]['ranking'] + "," +
                        res[i]['wsId'] + "," +
                        "'" + res[i]['wsName'] + "'" + "," +
                        "'" + res[i]['wsdesc'] + "'" + "," +
                        ")>处理</button>" + "</td>" +
                        "</tr>"
                }
                tmp += "            </tbody>\n" +
                    "        </table>";
                $("#mainContent").html(tmp)
            }
        })
    }

    function doWork(wId, ranking, wsId, wsName, desc) {
        let str = "<form action=\"/work/add\" method=\"post\" enctype=\"multipart/form-data\">\n" +
            "<input type=\"hidden\" value=" + wId + " name=\"wId\">\n" +
            "<input type=\"hidden\" value=" + ranking + " name=\"ranking\">\n" +

            "</div>" +
            "  <div class=\"layui-form-item\">\n" +
            "    <label class=\"layui-form-label\">事务ID</label>\n" +
            "    <div class=\"layui-input-block\">\n" +
            "      <input type=\"text\" disabled='disabled'  lay-verify=\"required\" value=" + wsId + " autocomplete=\"off\" class=\"layui-input\">\n" +
            "    </div>\n" +
            "  </div>" +

            "</div>" +
            "  <div class=\"layui-form-item\">\n" +
            "    <label class=\"layui-form-label\">事务名:</label>\n" +
            "    <div class=\"layui-input-block\">\n" +
            "      <input type=\"text\" disabled='disabled'  lay-verify=\"required\" value=" + wsName + " autocomplete=\"off\" class=\"layui-input\">\n" +
            "    </div>\n" +
            "  </div>" +

            "</div>" +
            "  <div class=\"layui-form-item\">\n" +
            "    <label class=\"layui-form-label\">事务描述:</label>\n" +
            "    <div class=\"layui-input-block\">\n" +
            "      <input type=\"text\" disabled='disabled'  lay-verify=\"required\" value=" + desc + " autocomplete=\"off\" class=\"layui-input\">\n" +
            "    </div>\n" +
            "  </div>" +

            "  <div class=\"layui-form-item\">\n" +
            "    <label class=\"layui-form-label\">文件：</label>" +
            "    <div class=\"layui-input-block\">\n" +
            "       <input type=\"file\" name=\"uploadFile\">\n" +
            "    </div>\n" +
            "  </div>" +

            "\t\t\t\t\t<input class=\"layui-btn layui-btn-warm layui-btn-sm\" type=\"submit\" value=\"提交\">\n" +
            "\t\t\t\t</form>";
        $("#mainContent").html(str);
    }

</script>


</body>
</html>
